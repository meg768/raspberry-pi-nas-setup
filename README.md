# Raspberry Pi NAS + Time Machine Setup

> *This guide was generated by ChatGPT to help document a full NAS and Time Machine setup on a Raspberry Pi.*

This guide sets up a Raspberry Pi named `pi-nas` as a NAS server with:
- A Time Machine-compatible backup share
- A general-purpose file share

## 📦 Requirements
- Raspberry Pi running Raspberry Pi OS (headless is fine)
- External hard drive mounted at `/mnt/samsung`
- macOS device for testing

---

## 🧰 Step 1: Install Samba and Avahi
```bash
sudo apt update
sudo apt install samba samba-common-bin avahi-daemon -y
sudo systemctl enable avahi-daemon
sudo systemctl start avahi-daemon
```

---


## 🗂️ Step 2: Create Shared Folders
```bash
sudo mkdir -p /mnt/samsung/timemachine
sudo mkdir -p /mnt/samsung/shared

sudo chown -R pi:pi /mnt/samsung/timemachine
sudo chown -R pi:pi /mnt/samsung/shared
sudo chmod -R 777 /mnt/samsung/timemachine
sudo chmod -R 777 /mnt/samsung/shared
```

---

## ⚙️ Step 3: Configure Samba
Edit Samba config:
```bash
sudo nano /etc/samba/smb.conf
```
Append this to the end:
```ini
[samsung]
   path = /mnt/samsung
   browseable = yes
   writable = yes
   guest ok = yes
   create mask = 0777
   directory mask = 0777
   public = yes

[shared]
   path = /mnt/samsung/shared
   browseable = yes
   writable = yes
   guest ok = yes
   create mask = 0777
   directory mask = 0777
   public = yes

[timemachine]
   path = /mnt/samsung/timemachine
   browseable = yes
   writable = yes
   guest ok = yes
   create mask = 0777
   directory mask = 0777
   public = yes
   vfs objects = fruit
   fruit:time machine = yes

```
Save and close.

---

## 🔁 Step 4: Restart Samba
```bash
sudo systemctl restart smbd
```

---

## 🖥️ Step 5: Connect from macOS
- Open Finder → Go → Connect to Server
- Enter: `smb://pi-nas.local/shared` or `smb://pi-nas.local/timemachine`
- Login as guest

To enable Time Machine:
- Go to **System Settings > Time Machine > Add Disk**
- Select `timemachine` share and login as guest

---

## ✅ Result
- Pi is discoverable via Bonjour (Avahi)

---

## 📝 Optional Next Steps
- Auto-mount shares on macOS
- Encrypt backups
- Add read-only media share

---

## 📂 Folder Structure
```
/mnt/samsung
├── timemachine
└── shared
```

---

